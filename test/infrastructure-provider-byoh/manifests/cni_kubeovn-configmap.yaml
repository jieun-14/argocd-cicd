apiVersion: v1
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: kube-ovn-configmap
  namespace: ${NAMESPACE}
data:
  kube-ovn.yaml: |
    ---
    # ovn-db-ip
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: ovn-init-db-ips
      namespace: kube-system
    ---
    # ovn-db-ip
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      namespace: kube-system
      name: ovn-init-db-ips
    rules:
    - apiGroups: [""]
      resources: ["configmaps"]
      verbs: ["create", "get", "list", "delete"]
    ---
    # ovn-db-ip
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: ovn-init-db-ips-binding
      namespace: kube-system
    subjects:
    - kind: ServiceAccount
      name: ovn-init-db-ips
      namespace: kube-system
    roleRef:
      kind: Role
      name: ovn-init-db-ips
      apiGroup: rbac.authorization.k8s.io
    ---
    # Source: kube-ovn/templates/ovn-sa.yaml
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: ovn
      namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-sa.yaml
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: ovn-ovs
      namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-sa.yaml
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: kube-ovn-cni
      namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-sa.yaml
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: kube-ovn-app
      namespace: kube-system
    ---
    # Source: kube-ovn/templates/vpc-nat-config.yaml
    kind: ConfigMap
    apiVersion: v1
    metadata:
      name: ovn-vpc-nat-config
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          kube-ovn vpc-nat common config
    data:
      image: docker.io/kubeovn/vpc-nat-gateway:v1.12.30
    ---
    # Source: kube-ovn/templates/vpc-nat-config.yaml
    kind: ConfigMap
    apiVersion: v1
    metadata:
      name: ovn-vpc-nat-gw-config
      namespace: kube-system
    data:
      enable-vpc-nat-gw: "true"
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vpc-dnses.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: vpc-dnses
        singular: vpc-dns
        shortNames:
          - vpc-dns
        kind: VpcDns
        listKind: VpcDnsList
      scope: Cluster
      versions:
        - additionalPrinterColumns:
            - jsonPath: .status.active
              name: Active
              type: boolean
            - jsonPath: .spec.vpc
              name: Vpc
              type: string
            - jsonPath: .spec.subnet
              name: Subnet
              type: string
          name: v1
          served: true
          storage: true
          subresources:
            status: {}
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    vpc:
                      type: string
                    subnet:
                      type: string
                    replicas:
                      type: integer
                      minimum: 1
                      maximum: 3
                status:
                  type: object
                  properties:
                    active:
                      type: boolean
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: switch-lb-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: switch-lb-rules
        singular: switch-lb-rule
        shortNames:
          - slr
        kind: SwitchLBRule
        listKind: SwitchLBRuleList
      scope: Cluster
      versions:
        - additionalPrinterColumns:
            - jsonPath: .spec.vip
              name: vip
              type: string
            - jsonPath: .status.ports
              name: port(s)
              type: string
            - jsonPath: .status.service
              name: service
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: age
              type: date
          name: v1
          served: true
          storage: true
          subresources:
            status: {}
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    namespace:
                      type: string
                    vip:
                      type: string
                    sessionAffinity:
                      type: string
                    ports:
                      items:
                        properties:
                          name:
                            type: string
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          protocol:
                            type: string
                          targetPort:
                            type: integer
                            minimum: 1
                            maximum: 65535
                        type: object
                      type: array
                    selector:
                      items:
                        type: string
                      type: array
                status:
                  type: object
                  properties:
                    ports:
                      type: string
                    service:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vpc-nat-gateways.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: vpc-nat-gateways
        singular: vpc-nat-gateway
        shortNames:
          - vpc-nat-gw
        kind: VpcNatGateway
        listKind: VpcNatGatewayList
      scope: Cluster
      versions:
        - additionalPrinterColumns:
            - jsonPath: .spec.vpc
              name: Vpc
              type: string
            - jsonPath: .spec.subnet
              name: Subnet
              type: string
            - jsonPath: .spec.lanIp
              name: LanIP
              type: string
          name: v1
          served: true
          storage: true
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    lanIp:
                      type: string
                    subnet:
                      type: string
                    externalSubnets:
                      items:
                        type: string
                      type: array
                    vpc:
                      type: string
                    selector:
                      type: array
                      items:
                        type: string
                    tolerations:
                      type: array
                      items:
                        type: object
                        properties:
                          key:
                            type: string
                          operator:
                            type: string
                            enum:
                              - Equal
                              - Exists
                          value:
                            type: string
                          effect:
                            type: string
                            enum:
                              - NoExecute
                              - NoSchedule
                              - PreferNoSchedule
                          tolerationSeconds:
                            type: integer
                    affinity:
                      properties:
                        nodeAffinity:
                          properties:
                            preferredDuringSchedulingIgnoredDuringExecution:
                              items:
                                properties:
                                  preference:
                                    properties:
                                      matchExpressions:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                      matchFields:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                    type: object
                                  weight:
                                    format: int32
                                    type: integer
                                required:
                                  - preference
                                  - weight
                                type: object
                              type: array
                            requiredDuringSchedulingIgnoredDuringExecution:
                              properties:
                                nodeSelectorTerms:
                                  items:
                                    properties:
                                      matchExpressions:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                      matchFields:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                    type: object
                                  type: array
                              required:
                                - nodeSelectorTerms
                              type: object
                          type: object
                        podAffinity:
                          properties:
                            preferredDuringSchedulingIgnoredDuringExecution:
                              items:
                                properties:
                                  podAffinityTerm:
                                    properties:
                                      labelSelector:
                                        properties:
                                          matchExpressions:
                                            items:
                                              properties:
                                                key:
                                                  type: string
                                                  x-kubernetes-patch-strategy: merge
                                                  x-kubernetes-patch-merge-key: key
                                                operator:
                                                  type: string
                                                values:
                                                  items:
                                                    type: string
                                                  type: array
                                              required:
                                                - key
                                                - operator
                                              type: object
                                            type: array
                                          matchLabels:
                                            additionalProperties:
                                              type: string
                                            type: object
                                        type: object
                                      namespaces:
                                        items:
                                          type: string
                                        type: array
                                      topologyKey:
                                        type: string
                                    required:
                                      - topologyKey
                                    type: object
                                  weight:
                                    format: int32
                                    type: integer
                                required:
                                  - podAffinityTerm
                                  - weight
                                type: object
                              type: array
                            requiredDuringSchedulingIgnoredDuringExecution:
                              items:
                                properties:
                                  labelSelector:
                                    properties:
                                      matchExpressions:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                              x-kubernetes-patch-strategy: merge
                                              x-kubernetes-patch-merge-key: key
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                      matchLabels:
                                        additionalProperties:
                                          type: string
                                        type: object
                                    type: object
                                  namespaces:
                                    items:
                                      type: string
                                    type: array
                                  topologyKey:
                                    type: string
                                required:
                                  - topologyKey
                                type: object
                              type: array
                          type: object
                        podAntiAffinity:
                          properties:
                            preferredDuringSchedulingIgnoredDuringExecution:
                              items:
                                properties:
                                  podAffinityTerm:
                                    properties:
                                      labelSelector:
                                        properties:
                                          matchExpressions:
                                            items:
                                              properties:
                                                key:
                                                  type: string
                                                  x-kubernetes-patch-strategy: merge
                                                  x-kubernetes-patch-merge-key: key
                                                operator:
                                                  type: string
                                                values:
                                                  items:
                                                    type: string
                                                  type: array
                                              required:
                                                - key
                                                - operator
                                              type: object
                                            type: array
                                          matchLabels:
                                            additionalProperties:
                                              type: string
                                            type: object
                                        type: object
                                      namespaces:
                                        items:
                                          type: string
                                        type: array
                                      topologyKey:
                                        type: string
                                    required:
                                      - topologyKey
                                    type: object
                                  weight:
                                    format: int32
                                    type: integer
                                required:
                                  - podAffinityTerm
                                  - weight
                                type: object
                              type: array
                            requiredDuringSchedulingIgnoredDuringExecution:
                              items:
                                properties:
                                  labelSelector:
                                    properties:
                                      matchExpressions:
                                        items:
                                          properties:
                                            key:
                                              type: string
                                              x-kubernetes-patch-strategy: merge
                                              x-kubernetes-patch-merge-key: key
                                            operator:
                                              type: string
                                            values:
                                              items:
                                                type: string
                                              type: array
                                          required:
                                            - key
                                            - operator
                                          type: object
                                        type: array
                                      matchLabels:
                                        additionalProperties:
                                          type: string
                                        type: object
                                    type: object
                                  namespaces:
                                    items:
                                      type: string
                                    type: array
                                  topologyKey:
                                    type: string
                                required:
                                  - topologyKey
                                type: object
                              type: array
                          type: object
                      type: object
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: iptables-eips.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: iptables-eips
        singular: iptables-eip
        shortNames:
          - eip
        kind: IptablesEIP
        listKind: IptablesEIPList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .status.ip
            name: IP
            type: string
          - jsonPath: .spec.macAddress
            name: Mac
            type: string
          - jsonPath: .status.nat
            name: Nat
            type: string
          - jsonPath: .spec.natGwDp
            name: NatGwDp
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    ip:
                      type: string
                    nat:
                      type: string
                    redo:
                      type: string
                    qosPolicy:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    v4ip:
                      type: string
                    v6ip:
                      type: string
                    macAddress:
                      type: string
                    natGwDp:
                      type: string
                    qosPolicy:
                      type: string
                    externalSubnet:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: iptables-fip-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: iptables-fip-rules
        singular: iptables-fip-rule
        shortNames:
          - fip
        kind: IptablesFIPRule
        listKind: IptablesFIPRuleList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .spec.eip
            name: Eip
            type: string
          - jsonPath: .status.v4ip
            name: V4ip
            type: string
          - jsonPath: .spec.internalIp
            name: InternalIp
            type: string
          - jsonPath: .status.v6ip
            name: V6ip
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          - jsonPath: .status.natGwDp
            name: NatGwDp
            type: string
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4ip:
                      type: string
                    v6ip:
                      type: string
                    natGwDp:
                      type: string
                    redo:
                      type: string
                    internalIp:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    eip:
                      type: string
                    internalIp:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: iptables-dnat-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: iptables-dnat-rules
        singular: iptables-dnat-rule
        shortNames:
          - dnat
        kind: IptablesDnatRule
        listKind: IptablesDnatRuleList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .spec.eip
            name: Eip
            type: string
          - jsonPath: .spec.protocol
            name: Protocol
            type: string
          - jsonPath: .status.v4ip
            name: V4ip
            type: string
          - jsonPath: .status.v6ip
            name: V6ip
            type: string
          - jsonPath: .spec.internalIp
            name: InternalIp
            type: string
          - jsonPath: .spec.externalPort
            name: ExternalPort
            type: string
          - jsonPath: .spec.internalPort
            name: InternalPort
            type: string
          - jsonPath: .status.natGwDp
            name: NatGwDp
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4ip:
                      type: string
                    v6ip:
                      type: string
                    natGwDp:
                      type: string
                    redo:
                      type: string
                    protocol:
                      type: string
                    internalIp:
                      type: string
                    internalPort:
                      type: string
                    externalPort:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    eip:
                      type: string
                    externalPort:
                      type: string
                    protocol:
                      type: string
                    internalIp:
                      type: string
                    internalPort:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: iptables-snat-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: iptables-snat-rules
        singular: iptables-snat-rule
        shortNames:
          - snat
        kind: IptablesSnatRule
        listKind: IptablesSnatRuleList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .spec.eip
            name: EIP
            type: string
          - jsonPath: .status.v4ip
            name: V4ip
            type: string
          - jsonPath: .status.v6ip
            name: V6ip
            type: string
          - jsonPath: .spec.internalCIDR
            name: InternalCIDR
            type: string
          - jsonPath: .status.natGwDp
            name: NatGwDp
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4ip:
                      type: string
                    v6ip:
                      type: string
                    natGwDp:
                      type: string
                    redo:
                      type: string
                    internalCIDR:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    eip:
                      type: string
                    internalCIDR:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ovn-eips.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: ovn-eips
        singular: ovn-eip
        shortNames:
          - oeip
        kind: OvnEip
        listKind: OvnEipList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .status.v4Ip
            name: V4IP
            type: string
          - jsonPath: .status.v6Ip
            name: V6IP
            type: string
          - jsonPath: .status.macAddress
            name: Mac
            type: string
          - jsonPath: .status.type
            name: Type
            type: string
          - jsonPath: .status.nat
            name: Nat
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    type:
                      type: string
                    nat:
                      type: string
                    ready:
                      type: boolean
                    v4Ip:
                      type: string
                    v6Ip:
                      type: string
                    macAddress:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    externalSubnet:
                      type: string
                    type:
                      type: string
                    v4Ip:
                      type: string
                    v6Ip:
                      type: string
                    macAddress:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ovn-fips.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: ovn-fips
        singular: ovn-fip
        shortNames:
          - ofip
        kind: OvnFip
        listKind: OvnFipList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .status.vpc
            name: Vpc
            type: string
          - jsonPath: .status.v4Eip
            name: V4Eip
            type: string
          - jsonPath: .status.v4Ip
            name: V4Ip
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          - jsonPath: .spec.ipType
            name: IpType
            type: string
          - jsonPath: .spec.ipName
            name: IpName
            type: string
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4Eip:
                      type: string
                    v4Ip:
                      type: string
                    vpc:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    ovnEip:
                      type: string
                    ipType:
                      type: string
                    ipName:
                      type: string
                    vpc:
                      type: string
                    v4Ip:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ovn-snat-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: ovn-snat-rules
        singular: ovn-snat-rule
        shortNames:
          - osnat
        kind: OvnSnatRule
        listKind: OvnSnatRuleList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .status.vpc
            name: Vpc
            type: string
          - jsonPath: .status.v4Eip
            name: V4Eip
            type: string
          - jsonPath: .status.v4IpCidr
            name: V4IpCidr
            type: string
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4Eip:
                      type: string
                    v4IpCidr:
                      type: string
                    vpc:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    ovnEip:
                      type: string
                    vpcSubnet:
                      type: string
                    ipName:
                      type: string
                    vpc:
                      type: string
                    v4IpCidr:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ovn-dnat-rules.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: ovn-dnat-rules
        singular: ovn-dnat-rule
        shortNames:
          - odnat
        kind: OvnDnatRule
        listKind: OvnDnatRuleList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
            - jsonPath: .status.vpc
              name: Vpc
              type: string
            - jsonPath: .spec.ovnEip
              name: Eip
              type: string
            - jsonPath: .status.protocol
              name: Protocol
              type: string
            - jsonPath: .status.v4Eip
              name: V4Eip
              type: string
            - jsonPath: .status.v4Ip
              name: V4Ip
              type: string
            - jsonPath: .status.internalPort
              name: InternalPort
              type: string
            - jsonPath: .status.externalPort
              name: ExternalPort
              type: string
            - jsonPath: .spec.ipName
              name: IpName
              type: string
            - jsonPath: .status.ready
              name: Ready
              type: boolean
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    v4Eip:
                      type: string
                    v4Ip:
                      type: string
                    vpc:
                      type: string
                    externalPort:
                      type: string
                    internalPort:
                      type: string
                    protocol:
                      type: string
                    ipName:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    ovnEip:
                      type: string
                    ipType:
                      type: string
                    ipName:
                      type: string
                    externalPort:
                      type: string
                    internalPort:
                      type: string
                    protocol:
                      type: string
                    vpc:
                      type: string
                    v4Ip:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vpcs.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - additionalPrinterColumns:
            - jsonPath: .status.enableExternal
              name: EnableExternal
              type: boolean
            - jsonPath: .status.enableBfd
              name: EnableBfd
              type: boolean
            - jsonPath: .status.standby
              name: Standby
              type: boolean
            - jsonPath: .status.subnets
              name: Subnets
              type: string
            - jsonPath: .status.extraExternalSubnets
              name: ExtraExternalSubnets
              type: string
            - jsonPath: .spec.namespaces
              name: Namespaces
              type: string
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enableExternal:
                      type: boolean
                    enableBfd:
                      type: boolean
                    namespaces:
                      items:
                        type: string
                      type: array
                    extraExternalSubnets:
                      items:
                        type: string
                      type: array
                    staticRoutes:
                      items:
                        properties:
                          policy:
                            type: string
                          cidr:
                            type: string
                          nextHopIP:
                            type: string
                          ecmpMode:
                            type: string
                          bfdId:
                            type: string
                          routeTable:
                            type: string
                        type: object
                      type: array
                    policyRoutes:
                      items:
                        properties:
                          priority:
                            type: integer
                          action:
                            type: string
                          match:
                            type: string
                          nextHopIP:
                            type: string
                        type: object
                      type: array
                    vpcPeerings:
                      items:
                        properties:
                          remoteVpc:
                            type: string
                          localConnectIP:
                            type: string
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    conditions:
                      items:
                        properties:
                          lastTransitionTime:
                            type: string
                          lastUpdateTime:
                            type: string
                          message:
                            type: string
                          reason:
                            type: string
                          status:
                            type: string
                          type:
                            type: string
                        type: object
                      type: array
                    default:
                      type: boolean
                    defaultLogicalSwitch:
                      type: string
                    router:
                      type: string
                    standby:
                      type: boolean
                    enableExternal:
                      type: boolean
                    enableBfd:
                      type: boolean
                    subnets:
                      items:
                        type: string
                      type: array
                    extraExternalSubnets:
                      items:
                        type: string
                      type: array
                    vpcPeerings:
                      items:
                        type: string
                      type: array
                    tcpLoadBalancer:
                      type: string
                    tcpSessionLoadBalancer:
                      type: string
                    udpLoadBalancer:
                      type: string
                    udpSessionLoadBalancer:
                      type: string
                    sctpLoadBalancer:
                      type: string
                    sctpSessionLoadBalancer:
                      type: string
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
      names:
        kind: Vpc
        listKind: VpcList
        plural: vpcs
        shortNames:
          - vpc
        singular: vpc
      scope: Cluster
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ips.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - name: v1
          served: true
          storage: true
          additionalPrinterColumns:
          - name: V4IP
            type: string
            jsonPath: .spec.v4IpAddress
          - name: V6IP
            type: string
            jsonPath: .spec.v6IpAddress
          - name: Mac
            type: string
            jsonPath: .spec.macAddress
          - name: Node
            type: string
            jsonPath: .spec.nodeName
          - name: Subnet
            type: string
            jsonPath: .spec.subnet
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    podName:
                      type: string
                    namespace:
                      type: string
                    subnet:
                      type: string
                    attachSubnets:
                      type: array
                      items:
                        type: string
                    nodeName:
                      type: string
                    ipAddress:
                      type: string
                    v4IpAddress:
                      type: string
                    v6IpAddress:
                      type: string
                    attachIps:
                      type: array
                      items:
                        type: string
                    macAddress:
                      type: string
                    attachMacs:
                      type: array
                      items:
                        type: string
                    containerID:
                      type: string
                    podType:
                      type: string
      scope: Cluster
      names:
        plural: ips
        singular: ip
        kind: IP
        shortNames:
          - ip
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vips.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: vips
        singular: vip
        shortNames:
          - vip
        kind: Vip
        listKind: VipList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          additionalPrinterColumns:
          - name: V4IP
            type: string
            jsonPath: .status.v4ip
          - name: V6IP
            type: string
            jsonPath: .status.v6ip
          - name: Mac
            type: string
            jsonPath: .status.mac
          - name: PMac
            type: string
            jsonPath: .spec.parentMac
          - name: Subnet
            type: string
            jsonPath: .spec.subnet
          - jsonPath: .status.ready
            name: Ready
            type: boolean
          - jsonPath: .status.type
            name: Type
            type: string
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    type:
                      type: string
                    ready:
                      type: boolean
                    v4ip:
                      type: string
                    v6ip:
                      type: string
                    mac:
                      type: string
                    pv4ip:
                      type: string
                    pv6ip:
                      type: string
                    pmac:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    namespace:
                      type: string
                    subnet:
                      type: string
                    type:
                      type: string
                    attachSubnets:
                      type: array
                      items:
                        type: string
                    v4ip:
                      type: string
                    macAddress:
                      type: string
                    v6ip:
                      type: string
                    parentV4ip:
                      type: string
                    parentMac:
                      type: string
                    parentV6ip:
                      type: string
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: subnets.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - name: Provider
            type: string
            jsonPath: .spec.provider
          - name: Vpc
            type: string
            jsonPath: .spec.vpc
          - name: Protocol
            type: string
            jsonPath: .spec.protocol
          - name: CIDR
            type: string
            jsonPath: .spec.cidrBlock
          - name: Private
            type: boolean
            jsonPath: .spec.private
          - name: NAT
            type: boolean
            jsonPath: .spec.natOutgoing
          - name: Default
            type: boolean
            jsonPath: .spec.default
          - name: GatewayType
            type: string
            jsonPath: .spec.gatewayType
          - name: V4Used
            type: number
            jsonPath: .status.v4usingIPs
          - name: V4Available
            type: number
            jsonPath: .status.v4availableIPs
          - name: V6Used
            type: number
            jsonPath: .status.v6usingIPs
          - name: V6Available
            type: number
            jsonPath: .status.v6availableIPs
          - name: ExcludeIPs
            type: string
            jsonPath: .spec.excludeIps
          - name: U2OInterconnectionIP
            type: string
            jsonPath: .status.u2oInterconnectionIP
          schema:
            openAPIV3Schema:
              type: object
              properties:
                metadata:
                  type: object
                  properties:
                    name:
                      type: string
                      pattern: ^[^0-9]
                status:
                  type: object
                  properties:
                    v4availableIPs:
                      type: number
                    v4usingIPs:
                      type: number
                    v6availableIPs:
                      type: number
                    v6usingIPs:
                      type: number
                    activateGateway:
                      type: string
                    dhcpV4OptionsUUID:
                      type: string
                    dhcpV6OptionsUUID:
                      type: string
                    u2oInterconnectionIP:
                      type: string
                    u2oInterconnectionVPC:
                      type: string
                    v4usingIPrange:
                      type: string
                    v4availableIPrange:
                      type: string
                    v6usingIPrange:
                      type: string
                    v6availableIPrange:
                      type: string
                    natOutgoingPolicyRules:
                      type: array
                      items:
                        type: object
                        properties:
                          ruleID:
                            type: string
                          action:
                            type: string
                            enum:
                              - nat
                              - forward
                          match:
                            type: object
                            properties:
                              srcIPs:
                                type: string
                              dstIPs:
                                type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    vpc:
                      type: string
                    default:
                      type: boolean
                    protocol:
                      type: string
                      enum:
                        - IPv4
                        - IPv6
                        - Dual
                    cidrBlock:
                      type: string
                    namespaces:
                      type: array
                      items:
                        type: string
                    gateway:
                      type: string
                    provider:
                      type: string
                    excludeIps:
                      type: array
                      items:
                        type: string
                    vips:
                      type: array
                      items:
                        type: string
                    gatewayType:
                      type: string
                    allowSubnets:
                      type: array
                      items:
                        type: string
                    gatewayNode:
                      type: string
                    natOutgoing:
                      type: boolean
                    externalEgressGateway:
                      type: string
                    policyRoutingPriority:
                      type: integer
                      minimum: 1
                      maximum: 32765
                    policyRoutingTableID:
                      type: integer
                      minimum: 1
                      maximum: 2147483647
                      not:
                        enum:
                          - 252 # compat
                          - 253 # default
                          - 254 # main
                          - 255 # local
                    mtu:
                      type: integer
                      minimum: 68
                      maximum: 65535
                    private:
                      type: boolean
                    vlan:
                      type: string
                    logicalGateway:
                      type: boolean
                    disableGatewayCheck:
                      type: boolean
                    disableInterConnection:
                      type: boolean
                    enableDHCP:
                      type: boolean
                    dhcpV4Options:
                      type: string
                    dhcpV6Options:
                      type: string
                    enableIPv6RA:
                      type: boolean
                    ipv6RAConfigs:
                      type: string
                    acls:
                      type: array
                      items:
                        type: object
                        properties:
                          direction:
                            type: string
                            enum:
                              - from-lport
                              - to-lport
                          priority:
                            type: integer
                            minimum: 0
                            maximum: 32767
                          match:
                            type: string
                          action:
                            type: string
                            enum:
                              - allow-related
                              - allow-stateless
                              - allow
                              - drop
                              - reject
                    natOutgoingPolicyRules:
                      type: array
                      items:
                        type: object
                        properties:
                          action:
                            type: string
                            enum:
                              - nat
                              - forward
                          match:
                            type: object
                            properties:
                              srcIPs:
                                type: string
                              dstIPs:
                                type: string
                    u2oInterconnection:
                      type: boolean
                    u2oInterconnectionIP:
                      type: string
                    enableLb:
                      type: boolean
                    enableEcmp:
                      type: boolean
                    enableMulticastSnoop:
                      type: boolean
                    routeTable:
                      type: string
      scope: Cluster
      names:
        plural: subnets
        singular: subnet
        kind: Subnet
        shortNames:
          - subnet
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: ippools.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - name: Subnet
            type: string
            jsonPath: .spec.subnet
          - name: IPs
            type: string
            jsonPath: .spec.ips
          - name: V4Used
            type: number
            jsonPath: .status.v4UsingIPs
          - name: V4Available
            type: number
            jsonPath: .status.v4AvailableIPs
          - name: V6Used
            type: number
            jsonPath: .status.v6UsingIPs
          - name: V6Available
            type: number
            jsonPath: .status.v6AvailableIPs
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    subnet:
                      type: string
                      x-kubernetes-validations:
                        - rule: "self == oldSelf"
                          message: "This field is immutable."
                    namespaces:
                      type: array
                      x-kubernetes-list-type: set
                      items:
                        type: string
                    ips:
                      type: array
                      minItems: 1
                      x-kubernetes-list-type: set
                      items:
                        type: string
                        anyOf:
                          - format: ipv4
                          - format: ipv6
                          - format: cidr
                          - pattern: ^(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.\.(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])$
                          - pattern: ^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|:)))\.\.((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|:)))$
                  required:
                    - subnet
                    - ips
                status:
                  type: object
                  properties:
                    v4AvailableIPs:
                      type: number
                    v4UsingIPs:
                      type: number
                    v6AvailableIPs:
                      type: number
                    v6UsingIPs:
                      type: number
                    v4AvailableIPRange:
                      type: string
                    v4UsingIPRange:
                      type: string
                    v6AvailableIPRange:
                      type: string
                    v6UsingIPRange:
                      type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
      scope: Cluster
      names:
        plural: ippools
        singular: ippool
        kind: IPPool
        shortNames:
          - ippool
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: vlans.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    id:
                      type: integer
                      minimum: 0
                      maximum: 4095
                    provider:
                      type: string
                    vlanId:
                      type: integer
                      description: Deprecated in favor of id
                    providerInterfaceName:
                      type: string
                      description: Deprecated in favor of provider
                  required:
                    - provider
                status:
                  type: object
                  properties:
                    subnets:
                      type: array
                      items:
                        type: string
          additionalPrinterColumns:
          - name: ID
            type: string
            jsonPath: .spec.id
          - name: Provider
            type: string
            jsonPath: .spec.provider
      scope: Cluster
      names:
        plural: vlans
        singular: vlan
        kind: Vlan
        shortNames:
          - vlan
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: provider-networks.kubeovn.io
    spec:
      group: kubeovn.io
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          schema:
            openAPIV3Schema:
              type: object
              properties:
                metadata:
                  type: object
                  properties:
                    name:
                      type: string
                      maxLength: 12
                      not:
                        enum:
                          - int
                spec:
                  type: object
                  properties:
                    defaultInterface:
                      type: string
                      maxLength: 15
                      pattern: '^[^/\s]+$'
                    customInterfaces:
                      type: array
                      items:
                        type: object
                        properties:
                          interface:
                            type: string
                            maxLength: 15
                            pattern: '^[^/\s]+$'
                          nodes:
                            type: array
                            items:
                              type: string
                    exchangeLinkName:
                      type: boolean
                    excludeNodes:
                      type: array
                      items:
                        type: string
                  required:
                    - defaultInterface
                status:
                  type: object
                  properties:
                    ready:
                      type: boolean
                    readyNodes:
                      type: array
                      items:
                        type: string
                    notReadyNodes:
                      type: array
                      items:
                        type: string
                    vlans:
                      type: array
                      items:
                        type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          node:
                            type: string
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
          additionalPrinterColumns:
          - name: DefaultInterface
            type: string
            jsonPath: .spec.defaultInterface
          - name: Ready
            type: boolean
            jsonPath: .status.ready
      scope: Cluster
      names:
        plural: provider-networks
        singular: provider-network
        kind: ProviderNetwork
        listKind: ProviderNetworkList
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: security-groups.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: security-groups
        singular: security-group
        shortNames:
          - sg
        kind: SecurityGroup
        listKind: SecurityGroupList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          schema:
            openAPIV3Schema:
              type: object
              properties:
                spec:
                  type: object
                  properties:
                    ingressRules:
                      type: array
                      items:
                        type: object
                        properties:
                          ipVersion:
                            type: string
                          protocol:
                            type: string
                          priority:
                            type: integer
                          remoteType:
                            type: string
                          remoteAddress:
                            type: string
                          remoteSecurityGroup:
                            type: string
                          portRangeMin:
                            type: integer
                          portRangeMax:
                            type: integer
                          policy:
                            type: string
                    egressRules:
                      type: array
                      items:
                        type: object
                        properties:
                          ipVersion:
                            type: string
                          protocol:
                            type: string
                          priority:
                            type: integer
                          remoteType:
                            type: string
                          remoteAddress:
                            type: string
                          remoteSecurityGroup:
                            type: string
                          portRangeMin:
                            type: integer
                          portRangeMax:
                            type: integer
                          policy:
                            type: string
                    allowSameGroupTraffic:
                      type: boolean
                status:
                  type: object
                  properties:
                    portGroup:
                      type: string
                    allowSameGroupTraffic:
                      type: boolean
                    ingressMd5:
                      type: string
                    egressMd5:
                      type: string
                    ingressLastSyncSuccess:
                      type: boolean
                    egressLastSyncSuccess:
                      type: boolean
          subresources:
            status: {}
      conversion:
        strategy: None
    ---
    # Source: kube-ovn/templates/kube-ovn-crd.yaml
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      name: qos-policies.kubeovn.io
    spec:
      group: kubeovn.io
      names:
        plural: qos-policies
        singular: qos-policy
        shortNames:
          - qos
        kind: QoSPolicy
        listKind: QoSPolicyList
      scope: Cluster
      versions:
        - name: v1
          served: true
          storage: true
          subresources:
            status: {}
          additionalPrinterColumns:
          - jsonPath: .spec.shared
            name: Shared
            type: string
          - jsonPath: .spec.bindingType
            name: BindingType
            type: string
          schema:
            openAPIV3Schema:
              type: object
              properties:
                status:
                  type: object
                  properties:
                    shared:
                      type: boolean
                    bindingType:
                      type: string
                    bandwidthLimitRules:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                          interface:
                            type: string
                          rateMax:
                            type: string
                          burstMax:
                            type: string
                          priority:
                            type: integer
                          direction:
                            type: string
                          matchType:
                            type: string
                          matchValue:
                            type: string
                    conditions:
                      type: array
                      items:
                        type: object
                        properties:
                          type:
                            type: string
                          status:
                            type: string
                          reason:
                            type: string
                          message:
                            type: string
                          lastUpdateTime:
                            type: string
                          lastTransitionTime:
                            type: string
                spec:
                  type: object
                  properties:
                    shared:
                      type: boolean
                    bindingType:
                      type: string
                    bandwidthLimitRules:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                          interface:
                            type: string
                          rateMax:
                            type: string
                          burstMax:
                            type: string
                          priority:
                            type: integer
                          direction:
                            type: string
                          matchType:
                            type: string
                          matchValue:
                            type: string
                        required:
                          - name
                      x-kubernetes-list-map-keys:
                        - name
                      x-kubernetes-list-type: map
    ---
    # Source: kube-ovn/templates/ovn-CR.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        rbac.authorization.k8s.io/system-only: "true"
      name: system:ovn
    rules:
      - apiGroups:
          - "kubeovn.io"
        resources:
          - vpcs
          - vpcs/status
          - vpc-nat-gateways
          - vpc-nat-gateways/status
          - subnets
          - subnets/status
          - ippools
          - ippools/status
          - ips
          - vips
          - vips/status
          - vlans
          - vlans/status
          - provider-networks
          - provider-networks/status
          - security-groups
          - security-groups/status
          - iptables-eips
          - iptables-fip-rules
          - iptables-dnat-rules
          - iptables-snat-rules
          - iptables-eips/status
          - iptables-fip-rules/status
          - iptables-dnat-rules/status
          - iptables-snat-rules/status
          - ovn-eips
          - ovn-fips
          - ovn-snat-rules
          - ovn-eips/status
          - ovn-fips/status
          - ovn-snat-rules/status
          - ovn-dnat-rules
          - ovn-dnat-rules/status
          - switch-lb-rules
          - switch-lb-rules/status
          - vpc-dnses
          - vpc-dnses/status
          - qos-policies
          - qos-policies/status
        verbs:
          - "*"
      - apiGroups:
          - ""
        resources:
          - pods
          - namespaces
        verbs:
          - get
          - list
          - patch
          - watch
      - apiGroups:
          - ""
        resources:
          - nodes
        verbs:
          - get
          - list
          - patch
          - update
          - watch
      - apiGroups:
          - ""
        resources:
          - pods/exec
        verbs:
          - create
      - apiGroups:
          - "k8s.cni.cncf.io"
        resources:
          - network-attachment-definitions
        verbs:
          - get
      - apiGroups:
          - ""
          - networking.k8s.io
        resources:
          - networkpolicies
          - configmaps
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - get
      - apiGroups:
          - ""
        resources:
          - services
          - services/status
        verbs:
          - get
          - list
          - update
          - create
          - delete
          - watch
      - apiGroups:
          - ""
        resources:
          - endpoints
        verbs:
          - create
          - update
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - statefulsets
          - deployments
          - deployments/scale
        verbs:
          - get
          - list
          - create
          - delete
          - update
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - create
          - patch
          - update
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - "*"
      - apiGroups:
          - "kubevirt.io"
        resources:
          - virtualmachines
          - virtualmachineinstances
        verbs:
          - get
          - list
      - apiGroups:
          - authentication.k8s.io
        resources:
          - tokenreviews
        verbs:
          - create
      - apiGroups:
          - authorization.k8s.io
        resources:
          - subjectaccessreviews
        verbs:
          - create
    ---
    # Source: kube-ovn/templates/ovn-CR.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        rbac.authorization.k8s.io/system-only: "true"
      name: system:ovn-ovs
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - patch
      - apiGroups:
          - ""
        resources:
          - services
          - endpoints
        verbs:
          - get
      - apiGroups:
          - apps
        resources:
          - controllerrevisions
        verbs:
          - get
          - list
    ---
    # Source: kube-ovn/templates/ovn-CR.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        rbac.authorization.k8s.io/system-only: "true"
      name: system:kube-ovn-cni
    rules:
      - apiGroups:
          - "kubeovn.io"
        resources:
          - subnets
          - vlans
          - provider-networks
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - ""
          - "kubeovn.io"
        resources:
          - ovn-eips
          - ovn-eips/status
          - nodes
          - pods
          - vlans
        verbs:
          - get
          - list
          - patch
          - watch
      - apiGroups:
          - "kubeovn.io"
        resources:
          - ips
        verbs:
          - get
          - update
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - create
          - patch
          - update
      - apiGroups:
          - ""
        resources:
          - configmaps
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - authentication.k8s.io
        resources:
          - tokenreviews
        verbs:
          - create
      - apiGroups:
          - authorization.k8s.io
        resources:
          - subjectaccessreviews
        verbs:
          - create
    ---
    # Source: kube-ovn/templates/ovn-CR.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        rbac.authorization.k8s.io/system-only: "true"
      name: system:kube-ovn-app
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
        verbs:
          - get
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - get
      - apiGroups:
          - authentication.k8s.io
        resources:
          - tokenreviews
        verbs:
          - create
      - apiGroups:
          - authorization.k8s.io
        resources:
          - subjectaccessreviews
        verbs:
          - create
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: ovn
    roleRef:
      name: system:ovn
      kind: ClusterRole
      apiGroup: rbac.authorization.k8s.io
    subjects:
      - kind: ServiceAccount
        name: ovn
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: ovn-ovs
    roleRef:
      name: system:ovn-ovs
      kind: ClusterRole
      apiGroup: rbac.authorization.k8s.io
    subjects:
      - kind: ServiceAccount
        name: ovn-ovs
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: kube-ovn-cni
    roleRef:
      name: system:kube-ovn-cni
      kind: ClusterRole
      apiGroup: rbac.authorization.k8s.io
    subjects:
      - kind: ServiceAccount
        name: kube-ovn-cni
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: kube-ovn-app
    roleRef:
      name: system:kube-ovn-app
      kind: ClusterRole
      apiGroup: rbac.authorization.k8s.io
    subjects:
      - kind: ServiceAccount
        name: kube-ovn-app
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: ovn
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: ovn
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: kube-ovn-cni
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: kube-ovn-cni
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/ovn-CRB.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: kube-ovn-app
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: kube-ovn-app
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/controller-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: kube-ovn-controller
      namespace: kube-system
      labels:
        app: kube-ovn-controller
    spec:
      selector:
        app: kube-ovn-controller
      ports:
        - port: 10660
          name: metrics
    ---
    # Source: kube-ovn/templates/monitor-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: kube-ovn-monitor
      namespace: kube-system
      labels:
        app: kube-ovn-monitor
    spec:
      ports:
        - name: metrics
          port: 10661
      type: ClusterIP
      selector:
        app: kube-ovn-monitor
      sessionAffinity: None
    ---
    # Source: kube-ovn/templates/nb-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: ovn-nb
      namespace: kube-system
    spec:
      ports:
        - name: ovn-nb
          protocol: TCP
          port: 6641
          targetPort: 6641
      type: ClusterIP
      selector:
        app: ovn-central
        ovn-nb-leader: "true"
      sessionAffinity: None
    ---
    # Source: kube-ovn/templates/northd-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: ovn-northd
      namespace: kube-system
    spec:
      ports:
        - name: ovn-northd
          protocol: TCP
          port: 6643
          targetPort: 6643
      type: ClusterIP
      selector:
        app: ovn-central
        ovn-northd-leader: "true"
      sessionAffinity: None
    ---
    # Source: kube-ovn/templates/ovncni-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: kube-ovn-cni
      namespace: kube-system
      labels:
        app: kube-ovn-cni
    spec:
      selector:
        app: kube-ovn-cni
      ports:
        - port: 10665
          name: metrics
    ---
    # Source: kube-ovn/templates/pinger-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: kube-ovn-pinger
      namespace: kube-system
      labels:
        app: kube-ovn-pinger
    spec:
      selector:
        app: kube-ovn-pinger
      ports:
        - port: 8080
          name: metrics
    ---
    # Source: kube-ovn/templates/sb-svc.yaml
    kind: Service
    apiVersion: v1
    metadata:
      name: ovn-sb
      namespace: kube-system
    spec:
      ports:
        - name: ovn-sb
          protocol: TCP
          port: 6642
          targetPort: 6642
      type: ClusterIP
      selector:
        app: ovn-central
        ovn-sb-leader: "true"
      sessionAffinity: None
    ---
    # Source: kube-ovn/templates/ovncni-ds.yaml
    kind: DaemonSet
    apiVersion: apps/v1
    metadata:
      name: kube-ovn-cni
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          This daemon set launches the kube-ovn cni daemon.
    spec:
      selector:
        matchLabels:
          app: kube-ovn-cni
      template:
        metadata:
          labels:
            app: kube-ovn-cni
            component: network
            type: infra
        spec:
          tolerations:
            - effect: NoSchedule
              operator: Exists
            - effect: NoExecute
              operator: Exists
            - key: CriticalAddonsOnly
              operator: Exists
          priorityClassName: system-node-critical
          serviceAccountName: kube-ovn-cni
          hostNetwork: true
          hostPID: true
          initContainers:
          - name: install-cni
            image: docker.io/kubeovn/kube-ovn:v1.12.30
            imagePullPolicy: IfNotPresent
            command: ["/kube-ovn/install-cni.sh"]
            securityContext:
              runAsUser: 0
              privileged: true
            volumeMounts:
              - mountPath: /opt/cni/bin
                name: cni-bin
              - mountPath: /usr/local/bin
                name: local-bin
          containers:
          - name: cni-server
            image: docker.io/kubeovn/kube-ovn:v1.12.30
            imagePullPolicy: IfNotPresent
            command:
              - bash
              - /kube-ovn/start-cniserver.sh
            args:
              - --enable-mirror=false
              - --mirror-iface=mirror0
              - --node-switch=join
              - --encap-checksum=true
              - --service-cluster-ip-range=10.96.0.0/12
              - --iface=
              - --dpdk-tunnel-iface=br-phy
              - --network-type=geneve
              - --default-interface-name=
              - --cni-conf-dir=/etc/cni/net.d
              - --cni-conf-file=/kube-ovn/01-kube-ovn.conflist
              - --cni-conf-name=01-kube-ovn.conflist
              - --logtostderr=false
              - --alsologtostderr=true
              - --log_file=/var/log/kube-ovn/kube-ovn-cni.log
              - --log_file_max_size=200
              - --enable-metrics=true
              - --kubelet-dir=/var/lib/kubelet
              - --enable-tproxy=false
              - --ovs-vsctl-concurrency=100
              - --secure-serving=false
            securityContext:
              runAsUser: 0
              privileged: true
            env:
              - name: ENABLE_SSL
                value: "false"
              - name: POD_IP
                valueFrom:
                  fieldRef:
                    fieldPath: status.podIP
              - name: KUBE_NODE_NAME
                valueFrom:
                  fieldRef:
                    fieldPath: spec.nodeName
              - name: MODULES
                value: "kube_ovn_fastpath.ko"
              - name: RPMS
                value: "openvswitch-kmod"
              - name: POD_NAME
                valueFrom:
                  fieldRef:
                    fieldPath: metadata.name
              - name: POD_NAMESPACE
                valueFrom:
                  fieldRef:
                    fieldPath: metadata.namespace
              - name: POD_IPS
                valueFrom:
                  fieldRef:
                    fieldPath: status.podIPs
              - name: ENABLE_BIND_LOCAL_IP
                value: "true"
              - name: DBUS_SYSTEM_BUS_ADDRESS
                value: "unix:path=/host/var/run/dbus/system_bus_socket"
            volumeMounts:
              - name: host-modules
                mountPath: /lib/modules
                readOnly: true
              - name: shared-dir
                mountPath: /var/lib/kubelet/pods
              - mountPath: /etc/openvswitch
                name: systemid
                readOnly: true
              - mountPath: /etc/cni/net.d
                name: cni-conf
              - mountPath: /run/openvswitch
                name: host-run-ovs
                mountPropagation: HostToContainer
              - mountPath: /run/ovn
                name: host-run-ovn
              - mountPath: /host/var/run/dbus
                name: host-dbus
                mountPropagation: HostToContainer
              - mountPath: /var/run/netns
                name: host-ns
                mountPropagation: HostToContainer
              - mountPath: /var/log/kube-ovn
                name: kube-ovn-log
              - mountPath: /var/log/openvswitch
                name: host-log-ovs
              - mountPath: /var/log/ovn
                name: host-log-ovn
              - mountPath: /etc/localtime
                name: localtime
                readOnly: true
              - mountPath: /tmp
                name: tmp
            readinessProbe:
              failureThreshold: 3
              periodSeconds: 7
              successThreshold: 1
              exec:
                command:
                  - /kube-ovn/kube-ovn-healthcheck
                  - --port=10665
                  - --tls=false
              timeoutSeconds: 5
            livenessProbe:
              failureThreshold: 3
              initialDelaySeconds: 30
              periodSeconds: 7
              successThreshold: 1
              exec:
                command:
                  - /kube-ovn/kube-ovn-healthcheck
                  - --port=10665
                  - --tls=false
              timeoutSeconds: 5
            resources:
              requests:
                cpu: 100m
                memory: 100Mi
              limits:
                cpu: 1000m
                memory: 1Gi
          nodeSelector:
            kubernetes.io/os: "linux"
          volumes:
            - name: host-modules
              hostPath:
                path: /lib/modules
            - name: shared-dir
              hostPath:
                path: /var/lib/kubelet/pods
            - name: systemid
              hostPath:
                path: /etc/origin/openvswitch
            - name: host-run-ovs
              hostPath:
                path: /run/openvswitch
            - name: host-run-ovn
              hostPath:
                path: /run/ovn
            - name: cni-conf
              hostPath:
                path: /etc/cni/net.d
            - name: cni-bin
              hostPath:
                path: /opt/cni/bin
            - name: host-ns
              hostPath:
                path: /var/run/netns
            - name: host-dbus
              hostPath:
                path: /var/run/dbus
            - name: kube-ovn-log
              hostPath:
                path: /var/log/kube-ovn
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: host-log-ovs
              hostPath:
                path: /var/log/openvswitch
            - name: host-log-ovn
              hostPath:
                path: /var/log/ovn
            - name: tmp
              hostPath:
                path: /tmp
            - name: local-bin
              hostPath:
                path: /usr/local/bin
    ---
    # Source: kube-ovn/templates/ovsovn-ds.yaml
    kind: DaemonSet
    apiVersion: apps/v1
    metadata:
      name: ovs-ovn
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          This daemon set launches the openvswitch daemon.
        chart-version: "kube-ovn-v1.12.30"
    spec:
      selector:
        matchLabels:
          app: ovs
      updateStrategy:
        type: RollingUpdate
        rollingUpdate:
          maxSurge: 1
          maxUnavailable: 0
      template:
        metadata:
          labels:
            app: ovs
            component: network
            type: infra
          annotations:
            chart-version: "kube-ovn-v1.12.30"
        spec:
          tolerations:
            - effect: NoSchedule
              operator: Exists
            - effect: NoExecute
              operator: Exists
            - key: CriticalAddonsOnly
              operator: Exists
          priorityClassName: system-node-critical
          serviceAccountName: ovn-ovs
          hostNetwork: true
          hostPID: true
          containers:
            - name: openvswitch
              image: docker.io/kubeovn/kube-ovn:v1.12.30
              imagePullPolicy: IfNotPresent
              command:
              - /kube-ovn/start-ovs.sh
              securityContext:
                runAsUser: 0
                privileged: false
                capabilities:
                  add:
                    - NET_ADMIN
                    - NET_BIND_SERVICE
                    - SYS_MODULE
                    - SYS_NICE
              env:
                - name: ENABLE_SSL
                  value: "false"
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIP
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: HW_OFFLOAD
                  value: "true"
                - name: TUNNEL_TYPE
                  value: "geneve"
                - name: KUBE_NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: OVN_DB_IPS
                  value: ${OVN_DB_IPS}
                - name: OVN_REMOTE_PROBE_INTERVAL
                  value: "10000"
                - name: OVN_REMOTE_OPENFLOW_INTERVAL
                  value: "180"
              volumeMounts:
                - mountPath: /var/run/netns
                  name: host-ns
                  mountPropagation: HostToContainer
                - mountPath: /lib/modules
                  name: host-modules
                  readOnly: true
                - mountPath: /var/run/openvswitch
                  name: host-run-ovs
                - mountPath: /var/run/ovn
                  name: host-run-ovn
                - mountPath: /sys
                  name: host-sys
                  readOnly: true
                - mountPath: /etc/openvswitch
                  name: host-config-openvswitch
                - mountPath: /etc/ovn
                  name: host-config-ovn
                - mountPath: /var/log/openvswitch
                  name: host-log-ovs
                - mountPath: /var/log/ovn
                  name: host-log-ovn
                - mountPath: /etc/localtime
                  name: localtime
                  readOnly: true
                - mountPath: /var/run/tls
                  name: kube-ovn-tls
                - mountPath: /var/run/containerd
                  name: cruntime
                  readOnly: true
              readinessProbe:
                exec:
                  command:
                    - bash
                    - /kube-ovn/ovs-healthcheck.sh
                initialDelaySeconds: 10
                periodSeconds: 5
                timeoutSeconds: 45
              livenessProbe:
                exec:
                  command:
                    - bash
                    - /kube-ovn/ovs-healthcheck.sh
                initialDelaySeconds: 60
                periodSeconds: 5
                failureThreshold: 5
                timeoutSeconds: 45
              resources:
                requests:
                  cpu: 200m
                  memory: 200Mi
                limits:
                  cpu: 2
                  memory: 1000Mi
          nodeSelector:
            kubernetes.io/os: "linux"
          volumes:
            - name: host-modules
              hostPath:
                path: /lib/modules
            - name: host-run-ovs
              hostPath:
                path: /run/openvswitch
            - name: host-run-ovn
              hostPath:
                path: /run/ovn
            - name: host-sys
              hostPath:
                path: /sys
            - name: host-config-openvswitch
              hostPath:
                path: /etc/origin/openvswitch
            - name: host-config-ovn
              hostPath:
                path: /etc/origin/ovn
            - name: host-log-ovs
              hostPath:
                path: /var/log/openvswitch
            - name: host-log-ovn
              hostPath:
                path: /var/log/ovn
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: kube-ovn-tls
              secret:
                optional: true
                secretName: kube-ovn-tls
            - name: host-ns
              hostPath:
                path: /var/run/netns
            - hostPath:
                path: /var/run/containerd
              name: cruntime
    ---
    # Source: kube-ovn/templates/pinger-ds.yaml
    kind: DaemonSet
    apiVersion: apps/v1
    metadata:
      name: kube-ovn-pinger
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          This daemon set launches the openvswitch daemon.
    spec:
      selector:
        matchLabels:
          app: kube-ovn-pinger
      updateStrategy:
        type: RollingUpdate
      template:
        metadata:
          labels:
            app: kube-ovn-pinger
            component: network
            type: infra
        spec:
          priorityClassName: system-node-critical
          serviceAccountName: kube-ovn-app
          hostPID: true
          containers:
            - name: pinger
              image: docker.io/kubeovn/kube-ovn:v1.12.30
              command:
              - /kube-ovn/kube-ovn-pinger
              args:
              - --external-address=208.67.222.222
              - --external-dns=opendns.com.
              - --logtostderr=false
              - --alsologtostderr=true
              - --log_file=/var/log/kube-ovn/kube-ovn-pinger.log
              - --log_file_max_size=200
              - --enable-metrics=true
              imagePullPolicy: IfNotPresent
              securityContext:
                runAsUser: 0
                privileged: false
              env:
                - name: ENABLE_SSL
                  value: "false"
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIP
                - name: HOST_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.hostIP
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
              volumeMounts:
                - mountPath: /var/run/openvswitch
                  name: host-run-ovs
                - mountPath: /var/run/ovn
                  name: host-run-ovn
                - mountPath: /etc/openvswitch
                  name: host-config-openvswitch
                - mountPath: /var/log/openvswitch
                  name: host-log-ovs
                  readOnly: true
                - mountPath: /var/log/ovn
                  name: host-log-ovn
                  readOnly: true
                - mountPath: /var/log/kube-ovn
                  name: kube-ovn-log
                - mountPath: /etc/localtime
                  name: localtime
                  readOnly: true
                - mountPath: /var/run/tls
                  name: kube-ovn-tls
              resources:
                requests:
                  cpu: 100m
                  memory: 100Mi
                limits:
                  cpu: 200m
                  memory: 400Mi
          nodeSelector:
            kubernetes.io/os: "linux"
          volumes:
            - name: host-run-ovs
              hostPath:
                path: /run/openvswitch
            - name: host-run-ovn
              hostPath:
                path: /run/ovn
            - name: host-config-openvswitch
              hostPath:
                path: /etc/origin/openvswitch
            - name: host-log-ovs
              hostPath:
                path: /var/log/openvswitch
            - name: kube-ovn-log
              hostPath:
                path: /var/log/kube-ovn
            - name: host-log-ovn
              hostPath:
                path: /var/log/ovn
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: kube-ovn-tls
              secret:
                optional: true
                secretName: kube-ovn-tls
    ---
    # Source: kube-ovn/templates/central-deploy.yaml
    kind: Deployment
    apiVersion: apps/v1
    metadata:
      name: ovn-central
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          OVN components: northd, nb and sb.
    spec:
      replicas: 3
      strategy:
        rollingUpdate:
          maxSurge: 0
          maxUnavailable: 1
        type: RollingUpdate
      selector:
        matchLabels:
          app: ovn-central
      template:
        metadata:
          labels:
            app: ovn-central
            component: network
            type: infra
        spec:
          tolerations:
            - effect: NoSchedule
              operator: Exists
            - effect: NoExecute
              operator: Exists
            - key: CriticalAddonsOnly
              operator: Exists
          affinity:
            podAntiAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                - labelSelector:
                    matchLabels:
                      app: ovn-central
                  topologyKey: kubernetes.io/hostname
          priorityClassName: system-cluster-critical
          serviceAccountName: ovn-ovs
          hostNetwork: true
          containers:
            - name: ovn-central
              image: docker.io/kubeovn/kube-ovn:v1.12.30
              imagePullPolicy: IfNotPresent
              command:
              - /kube-ovn/start-db.sh
              securityContext:
                runAsUser: 0
                privileged: false
                capabilities:
                  add:
                    - NET_BIND_SERVICE
                    - SYS_NICE
              env:
                - name: ENABLE_SSL
                  value: "false"
                - name: NODE_IPS
                  value: ${OVN_DB_IPS}
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIP
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: POD_IPS
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIPs
                - name: ENABLE_BIND_LOCAL_IP
                  value: "true"
                - name: PROBE_INTERVAL
                  value: "180000"
                - name: OVN_NORTHD_PROBE_INTERVAL
                  value: "5000"
                - name: OVN_LEADER_PROBE_INTERVAL
                  value: "5"
                - name: OVN_NORTHD_N_THREADS
                  value: "1"
                - name: ENABLE_COMPACT
                  value: "false"
              resources:
                requests:
                  cpu: 300m
                  memory: 200Mi
                limits:
                  cpu: 3
                  memory: 4Gi
              volumeMounts:
                - mountPath: /var/run/openvswitch
                  name: host-run-ovs
                - mountPath: /var/run/ovn
                  name: host-run-ovn
                - mountPath: /sys
                  name: host-sys
                  readOnly: true
                - mountPath: /etc/openvswitch
                  name: host-config-openvswitch
                - mountPath: /etc/ovn
                  name: host-config-ovn
                - mountPath: /var/log/openvswitch
                  name: host-log-ovs
                - mountPath: /var/log/ovn
                  name: host-log-ovn
                - mountPath: /etc/localtime
                  name: localtime
                  readOnly: true
                - mountPath: /var/run/tls
                  name: kube-ovn-tls
              readinessProbe:
                exec:
                  command:
                    - bash
                    - /kube-ovn/ovn-healthcheck.sh
                periodSeconds: 15
                timeoutSeconds: 45
              livenessProbe:
                exec:
                  command:
                    - bash
                    - /kube-ovn/ovn-healthcheck.sh
                initialDelaySeconds: 30
                periodSeconds: 15
                failureThreshold: 5
                timeoutSeconds: 45
          nodeSelector:
            kubernetes.io/os: "linux"
            kube-ovn/role: "master"
          volumes:
            - name: host-run-ovs
              hostPath:
                path: /run/openvswitch
            - name: host-run-ovn
              hostPath:
                path: /run/ovn
            - name: host-sys
              hostPath:
                path: /sys
            - name: host-config-openvswitch
              hostPath:
                path: /etc/origin/openvswitch
            - name: host-config-ovn
              hostPath:
                path: /etc/origin/ovn
            - name: host-log-ovs
              hostPath:
                path: /var/log/openvswitch
            - name: host-log-ovn
              hostPath:
                path: /var/log/ovn
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: kube-ovn-tls
              secret:
                optional: true
                secretName: kube-ovn-tls
    ---
    # Source: kube-ovn/templates/controller-deploy.yaml
    kind: Deployment
    apiVersion: apps/v1
    metadata:
      name: kube-ovn-controller
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          kube-ovn controller
    spec:
      replicas: 3
      selector:
        matchLabels:
          app: kube-ovn-controller
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          labels:
            app: kube-ovn-controller
            component: network
            type: infra
        spec:
          tolerations:
            - effect: NoSchedule
              operator: Exists
            - key: CriticalAddonsOnly
              operator: Exists
          affinity:
            nodeAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
                - preference:
                    matchExpressions:
                      - key: "ovn.kubernetes.io/ic-gw"
                        operator: NotIn
                        values:
                          - "true"
                  weight: 100
            podAntiAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                - labelSelector:
                    matchLabels:
                      app: kube-ovn-controller
                  topologyKey: kubernetes.io/hostname
          priorityClassName: system-cluster-critical
          serviceAccountName: ovn
          hostNetwork: true
          containers:
            - name: kube-ovn-controller
              image: docker.io/kubeovn/kube-ovn:v1.12.30
              imagePullPolicy: IfNotPresent
              args:
              - /kube-ovn/start-controller.sh
              - --default-ls=ovn-default
              - --default-cidr=10.16.0.0/16
              - --default-gateway=10.16.0.1
              - --default-gateway-check=true
              - --default-logical-gateway=false
              - --default-u2o-interconnection=false
              - --default-exclude-ips=
              - --cluster-router=ovn-cluster
              - --node-switch=join
              - --node-switch-cidr=100.64.0.0/16
              - --service-cluster-ip-range=10.96.0.0/12
              - --network-type=geneve
              - --default-provider-name=product
              - --default-interface-name=
              - --default-exchange-link-name=false
              - --default-vlan-name=ovn-vlan
              - --default-vlan-id=100
              - --ls-dnat-mod-dl-dst=true
              - --ls-ct-skip-dst-lport-ips=true
              - --pod-nic-type=veth_pair
              - --enable-lb=true
              - --enable-np=true
              - --enable-eip-snat=true
              - --enable-external-vpc=true
              - --enable-ecmp=false
              - --logtostderr=false
              - --alsologtostderr=true
              - --gc-interval=360
              - --inspect-interval=20
              - --log_file=/var/log/kube-ovn/kube-ovn-controller.log
              - --log_file_max_size=200
              - --enable-lb-svc=false
              - --keep-vm-ip=true
              - --enable-metrics=true
              - --node-local-dns-ip=
              - --secure-serving=false
              - --ovsdb-con-timeout=3
              - --ovsdb-inactivity-timeout=10
              securityContext:
                runAsUser: 0
                privileged: false
                capabilities:
                  add:
                    - NET_BIND_SERVICE
              env:
                - name: ENABLE_SSL
                  value: "false"
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBE_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBE_NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: OVN_DB_IPS
                  value: ${OVN_DB_IPS}
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIP
                - name: POD_IPS
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIPs
                - name: ENABLE_BIND_LOCAL_IP
                  value: "true"
              volumeMounts:
                - mountPath: /etc/localtime
                  name: localtime
                  readOnly: true
                - mountPath: /var/log/kube-ovn
                  name: kube-ovn-log
                # ovn-ic log directory
                - mountPath: /var/log/ovn
                  name: ovn-log
                - mountPath: /var/run/tls
                  name: kube-ovn-tls
              readinessProbe:
                exec:
                  command:
                    - /kube-ovn/kube-ovn-healthcheck
                    - --port=10660
                    - --tls=false
                periodSeconds: 3
                timeoutSeconds: 5
              livenessProbe:
                exec:
                  command:
                    - /kube-ovn/kube-ovn-healthcheck
                    - --port=10660
                    - --tls=false
                initialDelaySeconds: 300
                periodSeconds: 7
                failureThreshold: 5
                timeoutSeconds: 5
              resources:
                requests:
                  cpu: 200m
                  memory: 200Mi
                limits:
                  cpu: 1000m
                  memory: 1Gi
          nodeSelector:
            kubernetes.io/os: "linux"
          volumes:
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: kube-ovn-log
              hostPath:
                path: /var/log/kube-ovn
            - name: ovn-log
              hostPath:
                path: /var/log/ovn
            - name: kube-ovn-tls
              secret:
                optional: true
                secretName: kube-ovn-tls
    ---
    # Source: kube-ovn/templates/monitor-deploy.yaml
    kind: Deployment
    apiVersion: apps/v1
    metadata:
      name: kube-ovn-monitor
      namespace: kube-system
      annotations:
        kubernetes.io/description: |
          Metrics for OVN components: northd, nb and sb.
    spec:
      replicas: 1
      strategy:
        rollingUpdate:
          maxSurge: 1
          maxUnavailable: 1
        type: RollingUpdate
      selector:
        matchLabels:
          app: kube-ovn-monitor
      template:
        metadata:
          labels:
            app: kube-ovn-monitor
            component: network
            type: infra
        spec:
          tolerations:
            - effect: NoSchedule
              operator: Exists
            - key: CriticalAddonsOnly
              operator: Exists
          affinity:
            podAntiAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                - labelSelector:
                    matchLabels:
                      app: kube-ovn-monitor
                  topologyKey: kubernetes.io/hostname
          priorityClassName: system-cluster-critical
          serviceAccountName: kube-ovn-app
          hostNetwork: true
          containers:
            - name: kube-ovn-monitor
              image: docker.io/kubeovn/kube-ovn:v1.12.30
              imagePullPolicy: IfNotPresent
              command: ["/kube-ovn/start-ovn-monitor.sh"]
              args:
              - --secure-serving=false
              - --log_file=/var/log/kube-ovn/kube-ovn-monitor.log
              - --logtostderr=false
              - --alsologtostderr=true
              - --log_file_max_size=200
              securityContext:
                runAsUser: 0
                privileged: false
              env:
                - name: ENABLE_SSL
                  value: "false"
                - name: KUBE_NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIP
                - name: POD_IPS
                  valueFrom:
                    fieldRef:
                      fieldPath: status.podIPs
                - name: ENABLE_BIND_LOCAL_IP
                  value: "true"
              resources:
                requests:
                  cpu: 200m
                  memory: 200Mi
                limits:
                  cpu: 200m
                  memory: 200Mi
              volumeMounts:
                - mountPath: /var/run/openvswitch
                  name: host-run-ovs
                - mountPath: /var/run/ovn
                  name: host-run-ovn
                - mountPath: /etc/openvswitch
                  name: host-config-openvswitch
                - mountPath: /etc/ovn
                  name: host-config-ovn
                - mountPath: /var/log/ovn
                  name: host-log-ovn
                  readOnly: true
                - mountPath: /etc/localtime
                  name: localtime
                  readOnly: true
                - mountPath: /var/run/tls
                  name: kube-ovn-tls
                - mountPath: /var/log/kube-ovn
                  name: kube-ovn-log
              livenessProbe:
                failureThreshold: 3
                initialDelaySeconds: 30
                periodSeconds: 7
                successThreshold: 1
                exec:
                  command:
                    - /kube-ovn/kube-ovn-healthcheck
                    - --port=10661
                    - --tls=false
                timeoutSeconds: 5
              readinessProbe:
                failureThreshold: 3
                initialDelaySeconds: 30
                periodSeconds: 7
                successThreshold: 1
                exec:
                  command:
                    - /kube-ovn/kube-ovn-healthcheck
                    - --port=10661
                    - --tls=false
                timeoutSeconds: 5
          nodeSelector:
            kubernetes.io/os: "linux"
            kube-ovn/role: "master"
          volumes:
            - name: host-run-ovs
              hostPath:
                path: /run/openvswitch
            - name: host-run-ovn
              hostPath:
                path: /run/ovn
            - name: host-config-openvswitch
              hostPath:
                path: /etc/origin/openvswitch
            - name: host-config-ovn
              hostPath:
                path: /etc/origin/ovn
            - name: host-log-ovn
              hostPath:
                path: /var/log/ovn
            - name: localtime
              hostPath:
                path: /etc/localtime
            - name: kube-ovn-tls
              secret:
                optional: true
                secretName: kube-ovn-tls
            - name: kube-ovn-log
              hostPath:
                path: /var/log/kube-ovn
    ---
    # Source: kube-ovn/templates/pre-delete-hook.yaml
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: kube-ovn-pre-delete-hook
      namespace: kube-system
      annotations:
        # This is what defines this resource as a hook. Without this line, the
        # job is considered part of the release.
        "helm.sh/hook": pre-delete
        "helm.sh/hook-weight": "1"
        "helm.sh/hook-delete-policy": hook-succeeded
    ---
    # Source: kube-ovn/templates/pre-delete-hook.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        rbac.authorization.k8s.io/system-only: "true"
        # This is what defines this resource as a hook. Without this line, the
        # job is considered part of the release.
        "helm.sh/hook": pre-delete
        "helm.sh/hook-weight": "2"
        "helm.sh/hook-delete-policy": hook-succeeded
      name: system:kube-ovn-pre-delete-hook
    rules:
      - apiGroups:
          - kubeovn.io
        resources:
          - subnets
        verbs:
          - get
          - list
          - patch
    ---
    # Source: kube-ovn/templates/pre-delete-hook.yaml
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: kube-ovn-pre-delete-hook
      annotations:
        # This is what defines this resource as a hook. Without this line, the
        # job is considered part of the release.
        "helm.sh/hook": pre-delete
        "helm.sh/hook-weight": "3"
        "helm.sh/hook-delete-policy": hook-succeeded
    roleRef:
      name: system:kube-ovn-pre-delete-hook
      kind: ClusterRole
      apiGroup: rbac.authorization.k8s.io
    subjects:
      - kind: ServiceAccount
        name: kube-ovn-pre-delete-hook
        namespace: kube-system
    ---
    # Source: kube-ovn/templates/pre-delete-hook.yaml
    apiVersion: batch/v1
    kind: Job
    metadata:
      name: "kube-ovn-pre-delete-hook"
      namespace: kube-system
      labels:
        app.kubernetes.io/managed-by: "Helm"
        app.kubernetes.io/instance: "release-name"
        app.kubernetes.io/version: 1.12.30
        helm.sh/chart: "kube-ovn-v1.12.30"
      annotations:
        # This is what defines this resource as a hook. Without this line, the
        # job is considered part of the release.
        "helm.sh/hook": pre-delete
        "helm.sh/hook-weight": "4"
        "helm.sh/hook-delete-policy": hook-succeeded
    spec:
      completions: 1
      template:
        metadata:
          name: "release-name"
          labels:
            app.kubernetes.io/managed-by: "Helm"
            app.kubernetes.io/instance: "release-name"
            helm.sh/chart: "kube-ovn-v1.12.30"
            app: kube-ovn-pre-delete-hook
            component: job
        spec:
          tolerations:
            - key: ""
              operator: "Exists"
              effect: "NoSchedule"
          affinity:
            podAntiAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                - topologyKey: kubernetes.io/hostname
                  labelSelector:
                    matchExpressions:
                      - key: app
                        operator: In
                        values:
                          - kube-ovn-pre-delete-hook
                      - key: component
                        operator: In
                        values:
                          - job
          restartPolicy: Never
          hostNetwork: true
          nodeSelector:
            kubernetes.io/os: "linux"
          serviceAccount: kube-ovn-pre-delete-hook
          serviceAccountName: kube-ovn-pre-delete-hook
          containers:
            - name: remove-subnet-finalizer
              image: "docker.io/kubeovn/kube-ovn:v1.12.30"
              env:
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
              command:
                - sh
                - -c
                - /kube-ovn/remove-subnet-finalizer.sh 2>&1 | tee -a /var/log/kube-ovn/remove-subnet-finalizer.log
              volumeMounts:
                - mountPath: /var/log/kube-ovn
                  name: kube-ovn-log
          volumes:
            - name: kube-ovn-log
              hostPath:
                path: /var/log/kube-ovn
